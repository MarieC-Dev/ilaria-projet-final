<div class="recipePage">
    <!-- SECTION : Recipe presentation -->
    <app-recipe-presentation
        [image]="recipe.image"
        [title]="recipe.title"
        [description]="recipe.description"
        [authorName]="recipe.author.username"
        [authorRecipesNumber]="recipe.author.numberOfRecipes" >
    </app-recipe-presentation>
    <!-- ########## -->

    <!-- SECTION : Recipe details -->
    <section class="recipeDetails">
        <!-- CONTAINER : Recipe steps and comments -->
        <div class="recipeStepsComments">
            <!-- Recipe steps -->
            <div class="recipeSteps">
                <h3>Étape de préparation</h3>
    
                <div class="stepsContainer">
                    @for (step of recipe.steps; track step.id) {
                        <app-recipe-step 
                            [nbStep]="getNumberStep(step.id)"
                            [description]="step.description" />
                    }
                </div>
            </div>

            <hr class="dividingStepsComments">

            <!-- Recipe comments -->
            <div class="recipeComments">
                <h3>Commentaires</h3>
    
                <div class="commentsContainer">
                    @for (opinion of recipe.opinions; track opinion.id) {
                        <div class="commentAndAnswers">
                            <div #commentRef>
                                <app-recipe-comment
                                [classes]="getClassComment(recipe.author.username)"
                                [ids]="'commentId' + opinion.id"
                                [picture]="opinion.author.picture"
                                [username]="opinion.author.username"
                                [date]="opinion.created"
                                [note]="opinion.starScore"
                                [text]="opinion.text"
                                [answersArray]="opinion.answers.length" />
                            </div>
    
                            @if(opinion.answers.length > 0) {
                                <div class="answersList" [id]="'answersList' + opinion.id"> <!-- [appShowCommentAnswers]="'answersList' + opinion.id" -->
                                    @for (answer of opinion.answers; track answer.id) {
                                        <app-recipe-comment
                                            [classes]="getClassComment(recipe.author.username, answer.author.username)"
                                            [ids]="'answerId' + answer.id"
                                            [picture]="answer.author.picture"
                                            [username]="answer.author.username"
                                            [date]="answer.created"
                                            [text]="answer.text" />
                                    }
                                </div>
                            }
                        </div>
                    }
                </div>
            </div>
        </div>
        <!-- END -->

        <!-- CONTAINER : Recipe ingredients and share icons -->
        <nav class="recipeIngredientsTagsShare">
            <!-- Recipe ingredients -->
            <div class="recipeIngredients">
                <h3>Ingrédients</h3>

                <ul class="ingredientList">
                    @for (ingredient of recipe.ingredientsList; track ingredient.id) {
                        <li class="ingredient">{{ getQuantityIngredient(ingredient.id) }} {{ ingredient.unit }} {{ ingredient.name }}</li>
                    }
                </ul>
            </div>

            <!-- Recipe tags -->
            <div class="recipeTags">
                <h3>Tags</h3>

                <ul class="tagList">
                    @for (tag of recipe.tags; track tag.id) {
                        <li class="tag"> {{ tag.name }}</li>
                    }
                </ul>
            </div>

            <div class="recipeShare">
                <h3>Partager la recette</h3>

                <ul class="socialNetworks">
                    @for (social of socialNetworksList(); track $index) {
                        <app-social-networks 
                            [link]="social.href"
                            [pathImg]="social.path"
                            [altImg]="social.altImg" />
                    }
                </ul>
            </div>
        </nav>
        <!-- END -->
    </section>
    <!-- ########## -->

    <section class="otherRecipes">
        <h3>Autres recettes que vous pourriez aimer</h3>
        <!-- TODO : PB others recipes (recipe detail) -->
        <!-- <div class="otherRecipesList">
            @for (recipe of getOtherRecipesList(); track recipe.id;) {
                <app-recipe-item
                    [id]="recipe.id"
                    [picture]="recipe.image" 
                    [name]="recipe.title" 
                    [average]="getAverage(recipe.id)" 
                    [numberOfVotes]="recipe.opinions?.length"
                    [authorName]="recipe.author.username"
                />
            }
        </div> -->
    </section>
</div>
